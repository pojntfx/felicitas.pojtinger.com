<div class="pf-c-card pf-c-card--overlay" id="{{ .ID }}">
  <div class="pf-c-card__body pf-u-p-0 pf-u-display-flex">
    <img src="/img/octocat.svg" class="pf-u-p-md pf-u-pr-sm pf-x-octocat">
    <div class="lastcommit pf-u-flex-grow-1">
      <div class="pf-c-code-block pf-c-code-block--transparent pf-u-p-md pf-u-pl-sm">
        <div class="pf-c-code-block__header">
          <div class="pf-c-code-block__actions pf-c-code-block__actions--info">
<div class="pf-c-code-block__actions-item pf-u-py-sm pf-u-px-md">
              <span>
          <i class="fas fa-info-circle" aria-hidden="true"></i>
          Last GitHub commit by</span>
        <a class="lastcommit__user__url" target="_blank">
          <img id="lastcommit__user__url__img" />
        </a>
            </div>

            <div class="pf-c-code-block__actions-item pf-u-py-sm pf-u-px-md">
              <a clas="lastcommit__repo__url" target="_blank">
                <i class="fas fa-code-branch" aria-hidden="true"></i>
                <span class="lastcommit__repo__name"></span> (<span
                  class="lastcommit__commit__time"
                ></span
                >)
              </a>
            </div>
          </div>
        </div>
        <div class="pf-c-code-block__content">
          <pre
            class="pf-c-code-block__pre"
          ><code class="pf-c-code-block__code lastcommit__commit__message"></code></pre>
        </div>
      </div>
    </div>
  </div>
</div>

<noscript>Please enable JavaScript to view the latest GitHub commit.</noscript
><script type="module">
const base = "{{ .BaseURL }}";
const username = "{{ .Username }}";

const lastCommit = await (
  await fetch(`${base}api/github?username=${username}`)
).json();

// User
document.querySelector("#{{ .ID }} .lastcommit__user__url").href =
  lastCommit.userURL;

const img = document.querySelector("#{{ .ID }} #lastcommit__user__url__img");

img.alt = lastCommit.username+" with "+lastCommit.userFollowerCount+" followers";
img.src = "https://img.shields.io/badge/%40"+lastCommit.username+"-"+lastCommit.userFollowerCount+"%20followers-brightgreen?logo=github&style=social";

// Commit
document
  .querySelectorAll("#{{ .ID }} .lastcommit__commit__url")
  .forEach((c) => {
    c.href = lastCommit.lastCommitURL;
  });

const diff = Math.ceil((new Date() - new Date(lastCommit.lastCommitTime))/36e5);

document.querySelector("#{{ .ID }} .lastcommit__commit__time").innerText =
  diff >= 0 ? diff + " hours ago" : "just now";

document.querySelector("#{{ .ID }} .lastcommit__commit__message").innerText =
  lastCommit.lastCommitMessage;

// Repo
document.querySelector("#{{ .ID }} .lastcommit__repo__url").href =
  lastCommit.lastCommitRepoURL;

document.querySelector("#{{ .ID }} .lastcommit__repo__name").innerText =
  lastCommit.lastCommitRepoName;

</script>
